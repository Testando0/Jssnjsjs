<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KUROMIFLIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; margin: 0; }
        .grid-filmes { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 10px; 
            padding: 10px; 
        }
        @media (min-width: 768px) { .grid-filmes { grid-template-columns: repeat(6, 1fr); } }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <nav class="fixed top-0 w-full z-50 bg-black p-4 border-b border-white/10 flex justify-between items-center">
        <h1 class="text-red-600 text-2xl font-black cursor-pointer" onclick="location.reload()">KUROMIFLIX</h1>
        <input id="busca" type="text" placeholder="Pesquisar..." class="bg-zinc-800 border-none rounded px-4 py-1 text-sm outline-none">
    </nav>

    <div id="resultados-busca" class="fixed top-16 left-0 w-full bg-zinc-900 z-[60] hidden overflow-y-auto max-h-screen"></div>

    <main id="conteudo" class="pt-20"></main>

    <div id="tela-player" class="fixed inset-0 z-[100] bg-black hidden flex-col">
        <div class="p-4 bg-zinc-900 flex justify-between">
            <button onclick="fecharPlayer()" class="bg-red-600 text-white px-6 py-2 rounded font-bold uppercase text-xs">Voltar ao Início</button>
        </div>
        <div id="container-video" class="flex-grow"></div>
    </div>

    <script>
        const API_KEY = '8265bd1679663a7ea12ac168da84d2e8';
        const campoBusca = document.getElementById('busca');
        const divResultados = document.getElementById('resultados-busca');

        // BUSCA TMDB
        campoBusca.oninput = async () => {
            if (campoBusca.value.length < 3) { divResultados.classList.add('hidden'); return; }
            const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&language=pt-BR&query=${campoBusca.value}`);
            const data = await res.json();
            divResultados.classList.remove('hidden');
            divResultados.innerHTML = data.results.map(i => `
                <div onclick="abrirPlayer('${i.media_type === 'tv' ? 'tv' : 'movie'}', ${i.id})" class="p-4 border-b border-white/5 flex gap-4 cursor-pointer items-center bg-black hover:bg-zinc-800">
                    <img src="https://image.tmdb.org/t/p/w92${i.poster_path}" class="w-10">
                    <span class="font-bold">${i.title || i.name}</span>
                </div>
            `).join('');
        };

        function abrirPlayer(tipo, id) {
            divResultados.classList.add('hidden');
            campoBusca.value = '';
            // URL LIMPA - Sem proxy lixo e sem sandbox para não bloquear a API deles
            const url = `https://superflixapi.asia/${tipo}/${id}`;
            document.getElementById('container-video').innerHTML = `<iframe src="${url}" allowfullscreen allow="autoplay; fullscreen"></iframe>`;
            document.getElementById('tela-player').classList.remove('hidden');
            document.getElementById('tela-player').classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        function fecharPlayer() {
            document.getElementById('container-video').innerHTML = '';
            document.getElementById('tela-player').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        async function carregarHome() {
            const res = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${API_KEY}&language=pt-BR`);
            const data = await res.json();
            document.getElementById('conteudo').innerHTML = `<div class="grid-filmes">${data.results.map(i => `
                <div onclick="abrirPlayer('${i.media_type === 'tv' ? 'tv' : 'movie'}', ${i.id})" class="cursor-pointer hover:scale-105 transition">
                    <img src="https://image.tmdb.org/t/p/w500${i.poster_path}" class="rounded shadow-lg">
                    <p class="mt-2 text-[11px] font-bold truncate opacity-80 uppercase">${i.title || i.name}</p>
                </div>
            `).join('')}</div>`;
        }

        carregarHome();
    </script>
</body>
</html>
